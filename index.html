<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Payal - Happy Birthday (Private)</title>
  <meta name="robots" content="noindex, nofollow" />
  <meta name="description" content="Private birthday surprise for Payal - only for Sumit & Payal" />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+Devanagari:wght@400;700&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/exif-js/2.3.0/exif.min.js"></script>
  <script src="https://hammerjs.github.io/dist/hammer.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    :root {
      --bg: #0f1724;
      --card: #0b1220;
      --accent: #ff6b81;
      --muted: #9aa4b2;
      --glass: rgba(255,255,255,0.04);
      --shadow: 0 8px 30px rgba(2,6,23,0.6);
    }
    html, body {
      height: 100%;
      margin: 0;
      font-family: 'Noto Serif Devanagari', Inter, system-ui, sans-serif;
      background: linear-gradient(180deg, #071026 0%, #08152a 100%);
      color: #e6eef8;
      overflow-x: hidden;
      position: relative;
    }
    @keyframes bgShift {
      0% { background: linear-gradient(180deg, #071026 0%, #08152a 100%); }
      50% { background: linear-gradient(180deg, #08152a 0%, #071026 100%); }
      100% { background: linear-gradient(180deg, #071026 0%, #08152a 100%); }
    }
    body { animation: bgShift 20s infinite linear; }
    .center { display: flex; align-items: center; justify-content: center; }
    #stars {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 0;
      background: transparent;
    }
    #lockScreen {
      position: fixed;
      inset: 0;
      background: linear-gradient(180deg, rgba(2,6,23,0.95), rgba(2,6,23,0.98));
      z-index: 1000;
      display: flex;
      flex-direction: column;
      gap: 18px;
      align-items: center;
      justify-content: center;
      padding: 24px;
      opacity: 1;
      transition: opacity 0.5s ease;
    }
    #lockScreen.hidden { opacity: 0; pointer-events: none; }
    .card {
      background: var(--card);
      border-radius: 12px;
      padding: 24px;
      box-shadow: var(--shadow);
      width: min(560px, 96%);
      text-align: center;
      animation: slideUp 0.5s ease-out;
    }
    @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } }
    h1 { margin: 0 0 6px; font-size: 28px; font-weight: 700; }
    p.lead { color: var(--muted); margin: 0 0 18px; font-size: 14px; }
    .inputs { display: flex; gap: 8px; justify-content: center; flex-wrap: wrap; }
    input {
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.06);
      background: var(--glass);
      color: inherit;
      min-width: 140px;
      font-size: 14px;
    }
    input:focus { border-color: var(--accent); outline: none; }
    button {
      padding: 12px 16px;
      border-radius: 10px;
      border: 0;
      background: linear-gradient(90deg, var(--accent), #ff9ab3);
      color: #071026;
      font-weight: 700;
      cursor: pointer;
      font-size: 14px;
      transition: transform 0.2s, box-shadow 0.2s;
      touch-action: manipulation;
    }
    button:hover { transform: scale(1.05); box-shadow: 0 4px 12px rgba(255,107,129,0.3); }
    .small { font-size: 12px; color: var(--muted); }
    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 20px;
      background: rgba(2,6,23,0.7);
      position: sticky;
      top: 0;
      z-index: 100;
    }
    .logo { display: flex; gap: 10px; align-items: center; }
    .logo .dot {
      width: 36px;
      height: 36px;
      border-radius: 8px;
      background: linear-gradient(135deg, #ff6b81, #ff9ab3);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      animation: pulse 2s infinite;
    }
    @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }
    main { padding: 12px 20px 60px; }
    .intro { display: flex; gap: 12px; align-items: center; }
    .intro .hero { max-width: 100%; }
    .title { font-size: 28px; margin: 0; font-weight: 700; text-shadow: 0 2px 4px rgba(0,0,0,0.3); }
    .subtitle { color: var(--muted); margin-top: 6px; font-size: 16px; }
    .actions { margin-top: 12px; display: flex; gap: 8px; flex-wrap: wrap; }
    .gallery {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 12px;
      margin-top: 18px;
    }
    .photo {
      background: #fff;
      border-radius: 10px;
      padding: 8px;
      overflow: hidden;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      transition: transform 0.3s, box-shadow 0.3s;
      animation: slideInPhoto 0.5s ease forwards;
      position: relative;
      will-change: transform, opacity;
    }
    .photo:nth-child(odd) { animation-delay: 0.1s; }
    .photo:nth-child(even) { animation-delay: 0.2s; }
    @keyframes slideInPhoto {
      from { transform: translateX(-50px) scale(0.8); opacity: 0; }
      to { transform: translateX(0) scale(1); opacity: 1; }
    }
    .photo:hover { transform: scale(1.08) rotate(2deg); box-shadow: 0 6px 16px rgba(255,107,129,0.3); }
    .photo img {
      width: 100%;
      height: 120px;
      object-fit: cover;
      border-radius: 6px;
      display: block;
      background: #f0f0f0;
    }
    .photo::after {
      content: attr(data-caption);
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(0, 0, 0, 0.7);
      color: #fff;
      padding: 5px;
      font-size: 12px;
      opacity: 0;
      transition: opacity 0.3s;
    }
    .photo:hover::after { opacity: 1; }
    .video-section { margin-top: 20px; }
    .video-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 12px;
      margin-top: 12px;
    }
    .video-container {
      background: var(--glass);
      border-radius: 10px;
      padding: 8px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      animation: fadeIn 0.5s ease forwards;
    }
    video {
      width: 100%;
      height: 150px;
      object-fit: cover;
      border-radius: 6px;
      display: block;
    }
    .modal {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      background: rgba(2,6,23,0.85);
      z-index: 1200;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    .modal.open { display: flex; opacity: 1; }
    .modal .slide {
      width: min(90%, 800px);
      height: min(80%, 600px);
      background: #071428;
      border-radius: 10px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      padding: 10px;
      animation: zoomIn 0.4s ease;
    }
    @keyframes zoomIn { from { transform: scale(0.8); opacity: 0; } }
    .slide img {
      width: 100%;
      height: calc(100% - 60px);
      object-fit: contain;
      border-radius: 8px;
      background: #061220;
      transition: opacity 0.5s ease, transform 0.5s ease;
    }
    .slide img.fade { opacity: 0; transform: scale(0.95); }
    .caption {
      color: var(--muted);
      text-align: center;
      font-size: 14px;
      padding: 6px 0;
    }
    .controls { display: flex; justify-content: space-between; align-items: center; }
    .controls button {
      background: transparent;
      border: 1px solid rgba(255,255,255,0.06);
      color: var(--muted);
      padding: 10px 14px;
      border-radius: 6px;
      font-size: 13px;
    }
    .controls button:hover { background: var(--accent); color: #071026; }
    .progress {
      width: 100%;
      height: 4px;
      background: var(--glass);
      position: absolute;
      top: 0;
      left: 0;
    }
    .progress-fill {
      height: 100%;
      background: var(--accent);
      width: 0;
      transition: width 2.5s linear;
    }
    .heart-slideshow {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 20px;
      position: relative;
      padding: 20px 0;
    }
    .heart-container {
      position: relative;
      overflow: hidden;
      background: var(--glass);
      border-radius: 10px;
      will-change: transform, opacity;
    }
    .heart-container.large {
      width: 300px;
      height: 300px;
    }
    .heart-container.small {
      width: 150px;
      height: 150px;
    }
    .heart-container img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      position: absolute;
      top: 0;
      left: 0;
      opacity: 0;
      transition: opacity 1s ease;
    }
    .heart-container img.active {
      opacity: 1;
      animation: slideInHeart 1s ease forwards;
    }
    @keyframes slideInHeart {
      from { transform: translateX(50px) scale(0.8); opacity: 0; }
      to { transform: translateX(0) scale(1); opacity: 1; }
    }
    .shayari-section { margin-top: 20px; }
    .shayari {
      background: var(--glass);
      padding: 12px;
      border-radius: 8px;
      border: 1px solid rgba(255,255,255,0.03);
      text-align: center;
      font-size: 16px;
      line-height: 1.6;
      color: #fff;
      animation: fadeIn 0.5s ease forwards;
      margin-bottom: 12px;
    }
    .love-letter-section { margin-top: 20px; text-align: center; }
    .love-letter {
      background: linear-gradient(135deg, rgba(255,107,129,0.1), rgba(255,154,179,0.1));
      border: 1px solid rgba(255,107,129,0.2);
      border-radius: 10px;
      padding: 16px;
      max-width: 100%;
      margin: 0 auto;
      box-shadow: 0 4px 16px rgba(255,107,129,0.2);
      animation: fadeIn 0.7s ease forwards;
    }
    .love-letter h3 { font-size: 22px; margin: 0 0 12px; color: #ff9ab3; }
    .love-letter p { font-size: 14px; line-height: 1.6; color: #e6eef8; margin: 0 0 10px; }
    .timeline-section { margin-top: 20px; overflow-x: auto; padding-bottom: 12px; }
    .timeline { display: flex; gap: 12px; padding: 12px; min-width: max-content; }
    .timeline-card {
      background: var(--glass);
      border: 1px solid rgba(255,255,255,0.03);
      border-radius: 10px;
      padding: 12px;
      width: 220px;
      text-align: center;
      animation: fadeIn 0.5s ease forwards;
    }
    .timeline-card h4 { font-size: 16px; margin: 0 0 6px; color: #ff9ab3; }
    .timeline-card p { font-size: 12px; color: var(--muted); }
    .timeline-card img { width: 100%; height: 100px; object-fit: cover; border-radius: 6px; margin-top: 6px; }
    .music-section { margin-top: 20px; text-align: center; }
    .music-player {
      background: var(--glass);
      border: 1px solid rgba(255,255,255,0.03);
      border-radius: 10px;
      padding: 12px;
      max-width: 100%;
      margin: 0 auto;
      animation: fadeIn 0.5s ease forwards;
    }
    .music-player select {
      width: 100%;
      padding: 8px;
      border-radius: 6px;
      border: 1px solid rgba(255,255,255,0.06);
      background: var(--card);
      color: #e6eef8;
      margin-bottom: 8px;
      font-size: 14px;
    }
    .gift-box {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 160px;
      height: 160px;
      background: linear-gradient(135deg, #ff6b81, #ff9ab3);
      border-radius: 10px;
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1300;
      cursor: pointer;
      box-shadow: 0 6px 16px rgba(0,0,0,0.4);
    }
    .gift-box.open { animation: openGift 1s forwards; }
    @keyframes openGift { 0% { transform: translate(-50%, -50%) scale(1); opacity: 1; } 50% { transform: translate(-50%, -50%) scale(1.2); } 100% { transform: translate(-50%, -50%) scale(0); opacity: 0; } }
    .gift-box::before { content: '🎁'; font-size: 64px; }
    .love-meter-section { margin-top: 20px; text-align: center; }
    .love-meter {
      background: var(--glass);
      border: 1px solid rgba(255,255,255,0.03);
      border-radius: 10px;
      padding: 12px;
      max-width: 100%;
      margin: 0 auto;
      animation: fadeIn 0.5s ease forwards;
    }
    .love-meter p { font-size: 16px; margin: 0 0 10px; color: #ff9ab3; }
    .meter-bar { width: 100%; height: 16px; background: #071428; border-radius: 8px; overflow: hidden; margin-top: 8px; }
    .meter-fill { height: 100%; background: linear-gradient(90deg, #ff6b81, #ff9ab3); transition: width 1s ease; }
    .guestbook { margin-top: 20px; }
    .guestbook textarea {
      width: 100%;
      min-height: 100px;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid rgba(255,255,255,0.06);
      background: var(--glass);
      color: inherit;
      resize: vertical;
      margin-bottom: 10px;
      font-size: 14px;
    }
    .messages { display: flex; flex-direction: column; gap: 10px; }
    .message { background: var(--glass); padding: 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.03); animation: slideIn 0.3s ease; }
    @keyframes slideIn { from { transform: translateX(-20px); opacity: 0; } }
    footer { position: fixed; left: 0; right: 0; bottom: 0; padding: 10px 16px; display: flex; justify-content: space-between; align-items: center; background: linear-gradient(180deg, transparent, rgba(2,6,23,0.7)); font-size: 12px; }
    canvas#fire { position: fixed; inset: 0; pointer-events: none; z-index: 1500; }
    @media (max-width: 640px) {
      .intro { flex-direction: column; text-align: center; }
      .title { font-size: 24px; }
      .card { padding: 16px; }
      .modal .slide { height: min(70%, 480px); }
      .photo img { height: 100px; }
      .gallery { grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); }
      .video-grid { grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); }
      video { height: 120px; }
      .shayari { font-size: 14px; }
      .love-letter { padding: 12px; }
      .love-letter h3 { font-size: 20px; }
      .timeline-card { width: 200px; }
      .timeline-card img { height: 80px; }
      .heart-slideshow { flex-direction: column; align-items: center; gap: 10px; }
      .heart-container.large { width: 250px; height: 250px; }
      .heart-container.small { width: 120px; height: 120px; }
      button { padding: 10px 14px; font-size: 13px; }
      .inputs input { min-width: 120px; font-size: 13px; }
    }
    @media (max-width: 400px) {
      .gallery { grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); }
      .photo img { height: 80px; }
      .heart-container.large { width: 200px; height: 200px; }
      .heart-container.small { width: 100px; height: 100px; }
    }
  </style>
</head>
<body>
  <canvas id="stars" width="800" height="600" aria-hidden="true"></canvas>
  <div id="lockScreen">
    <div class="card">
      <div style="display:flex;gap:10px;align-items:center;justify-content:center;margin-bottom:10px">
        <div style="font-size:20px;font-weight:800;">🎉</div>
        <div style="text-align:left">
          <h1>Payal ke liye Surprise</h1>
          <p class="lead">Ye site sirf Sumit aur Payal ke liye hai. Username & password dalein.</p>
        </div>
      </div>
      <div class="inputs">
        <label for="username" class="sr-only">Username</label>
        <input id="username" placeholder="Username (example: Sumit)" aria-label="Username" />
        <label for="password" class="sr-only">Password</label>
        <input id="password" placeholder="Password" type="password" aria-label="Password" />
      </div>
      <div style="margin-top:12px;display:flex;gap:8px;justify-content:center">
        <button id="unlockBtn">Unlock</button>
        <button id="openGuest" style="background:transparent;color:var(--muted);border:1px solid rgba(255,255,255,0.06)">Help</button>
      </div>
      <p class="small" style="margin-top:10px">Note: Password bhool gaye? Sumit se contact karo!</p>
    </div>
  </div>

  <div id="siteContent" style="display:none">
    <header>
      <div class="logo">
        <div class="dot">S</div>
        <div>
          <div style="font-weight:700">Sumit ❤️ Payal</div>
          <div style="font-size:12px;color:var(--muted)">A private birthday surprise</div>
        </div>
      </div>
      <div class="small">Private link • Not indexed</div>
    </header>

    <main>
      <section class="intro">
        <div class="hero">
          <h2 class="title">Happy Birthday, Payal! 🎂💖</h2>
          <p class="subtitle">Tumhare liye ek special website — photos, videos, shayari, love letter, timeline, aur surprises!</p>
          <div class="actions">
            <button id="openSurprise">Open Surprise</button>
            <button id="startHeartSlideshow" style="background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)">Start Heart Slideshow</button>
            <button id="downloadBook">Download Memory Book 📖</button>
          </div>
        </div>
        <div style="flex:1"></div>
      </section>

      <section class="heart-slideshow" id="heartSlideshow">
        <div class="heart-container small" id="heartLeft"></div>
        <div class="heart-container large" id="heartCenter"></div>
        <div class="heart-container small" id="heartRight"></div>
      </section>

      <section>
        <h3 style="margin-top:18px;font-size:22px;font-weight:700">Our Memories</h3>
        <div class="gallery" id="gallery"></div>
      </section>

      <section class="video-section">
        <h3 style="margin-top:18px;font-size:22px;font-weight:700">Special Videos for You</h3>
        <div class="video-grid" id="videoGrid"></div>
      </section>

      <section class="timeline-section">
        <h3 style="margin-top:18px;font-size:22px;font-weight:700">Hamari Yatra</h3>
        <div class="timeline" id="timeline">
          <div class="timeline-card">
            <h4>6 June 2022</h4>
            <p>Pehli mulaqat — Jab hum mile aur dil se dil tak ek kahani shuru hui.</p>
            <img src="images/payal1.jpg" alt="First Meeting" />
          </div>
          <div class="timeline-card">
            <h4>14 February 2023</h4>
            <p>Pyaar ka aagaz — Tum meri zindagi ka sabse khubsurat hissa ban gayi.</p>
            <img src="images/payal2.jpg" alt="Relationship Start" />
          </div>
          <div class="timeline-card">
            <h4>Today</h4>
            <p>Tumhara janmdin — Ek aur saal pyaar, khushi, aur yaadon ka!</p>
            <img src="images/payal3.jpg" alt="Birthday" />
          </div>
        </div>
      </section>

      <section class="music-section">
        <h3 style="margin-top:18px;font-size:22px;font-weight:700">Tumhare liye Gaane</h3>
        <div class="music-player">
          <select id="songSelect" aria-label="Select a song">
            <option value="audio/song1.mp3">SumitAndPayal</option>
            <option value="audio/song2.mp3">Sumit ki biwi Payal</option>
            <option value="audio/song3.mp3">Tere liye Payal</option>
          </select>
          <div style="display:flex;gap:8px;justify-content:center">
            <button id="playSong">Play ▶</button>
            <button id="pauseSong">Pause ⏸</button>
          </div>
        </div>
      </section>

      <section class="shayari-section">
        <h3 style="margin-top:18px;font-size:22px;font-weight:700">Tumhare liye Shayari</h3>
        <div id="shayariContainer"></div>
      </section>

      <section class="love-letter-section">
        <h3 style="margin-top:18px;font-size:22px;font-weight:700">Meri Payal ke liye Love Letter</h3>
        <div class="love-letter">
          <h3>Pyaari Payal,</h3>
          <p>Aaj tumhara janmdin hai, aur mera dil sirf tumhare liye dhadakta hai. 6 June 2022 ko jab hum mile, mujhe nahi pata tha ke ek din tum meri dunia ban jaogi. 14 February 2023 se lekar aaj tak, har pal tumhare sath ek khubsurat kahani jaisa hai.</p>
          <p>Tumhari muskan meri sabse badi khushi hai, aur tumhara pyaar mera sabse anmol khazana. Har shayari, har photo, har video jo maine yahan rakha, woh sirf ek chhoti si koshish hai apne dil ke jazbaat tum tak pahunchane ki. Tum meri wajah ho, meri khushi ho, aur meri har dua ka jawab ho. Meri biwi vese yaar aaj tumne mujhe data aur fir bhi mein datta hu tumhe yaar me kya hi kahu tumare bare mein tumari aankho me hi bash jana tumari gaud mein sar rahke soo jana chahta hu aur mera favourite dialogue toh bhul hi gya tumari kamjori h joh me toh tumara bacha hu na chota sa masoom sa pyara sa kyu shi kaha na hu ki nahi.</p>
          <p>Janmdin mubarak ho, meri jaan! Hamesha mere sath raho, kyunki tum bin ye dil adhoora hai. ❤️</p>
          <p>Hamesha tera, <br>Sumit</p>
        </div>
      </section>

      <section class="love-meter-section">
        <h3 style="margin-top:18px;font-size:22px;font-weight:700">Hamara Pyaar Meter</h3>
        <div class="love-meter">
          <p id="loveResult">Click to see our love percentage!</p>
          <button id="checkLove">Check Love 💖</button>
          <div class="meter-bar">
            <div class="meter-fill" id="meterFill" style="width:0%"></div>
          </div>
        </div>
      </section>

      <section class="guestbook">
        <h3 style="margin-top:18px;font-size:22px;font-weight:700">Guestbook</h3>
        <label for="guestbookInput" class="sr-only">Guestbook message</label>
        <textarea id="guestbookInput" placeholder="Apna message yahan likhein..." aria-label="Guestbook message"></textarea>
        <button id="submitMessage">Submit Message</button>
        <div class="messages" id="messages"></div>
      </section>
    </main>

    <footer>
      <div class="small">Made with ❤️ by Sumit</div>
      <div class="small">Keep this link & password secret</div>
    </footer>
  </div>

  <div class="modal" id="modal" role="dialog" aria-labelledby="caption">
    <div class="slide">
      <div class="progress"><div class="progress-fill" id="progressFill"></div></div>
      <img id="modalImg" src="" alt="" aria-describedby="caption" />
      <div class="caption" id="caption"></div>
      <div class="controls">
        <div>
          <button id="prev" aria-label="Previous image">◀ Prev</button>
          <button id="next" aria-label="Next image">Next ▶</button>
          <button id="toggleSlideshow" aria-label="Toggle slideshow">Pause ▶</button>
        </div>
        <div>
          <button id="closeModal" aria-label="Close modal">Close ✕</button>
        </div>
      </div>
    </div>
  </div>

  <div class="gift-box" id="giftBox" role="button" aria-label="Open surprise gift"></div>

  <canvas id="fire" width="800" height="600" aria-hidden="true"></canvas>

  <audio id="bdayAudio" preload="auto" src="audio/song1.mp3" loop></audio>

  <script>
    // Configuration
    const TOTAL_IMAGES = 30;
    const SHAYARI_LIST = [
      'Tum meri wajah ho har khushi ki, Payal meri zindagi ki roshni ki. ❤️',
      'Tere bina dil lagta nahi, tu hai meri har dua ka sila. 🎉',
      'Tumhari muskan meri dunia hai, Payal tu meri khushi ka jahan hai. 💖',
      'Har pal tere sath ek kahani, Payal tu meri zindagi ki rani. 🌟',
      'Tere pyar mein khoya hai dil, Payal tu meri zindagi ka silsila. 💕',
      'Tum se hi toh meri subah hai, Payal tu meri har shaam ka nasha hai. ✨',
      'Tere bin ye jahan adhura sa, Payal tu mera har pal ka pura sa. 🥰',
      'Tum ek chand ho, main tera aasman, Payal sada rahe hum dono ka ye pyar jawan. 🌙',
      'Teri baaton mein hai jadoo sa, Payal tu hai mera dil ka khuda sa. 💞',
      'Tum meri har khushi ka karan, Payal tu mera har pal ka armaan. 💝'
    ];
    const VIDEOS = [
      { src: 'videos/anime1.mp4', type: 'video/mp4' },
      { src: 'videos/anime2.mp4', type: 'video/mp4' },
      { src: 'videos/anime3.mp4', type: 'video/mp4' },
      { src: 'videos/anime4.mp4', type: 'video/mp4' }
    ];

    // State
    const imageFiles = [];
    const captions = Array(TOTAL_IMAGES).fill().map((_, i) => `Memory ${i + 1}: A special moment with you!`);
    let currentImageIndex = 1;
    let slideshowInterval = null;
    let isSlideshowRunning = false;
    let heartInterval = null;

    // DOM Elements
    const lockScreen = document.getElementById('lockScreen');
    const siteContent = document.getElementById('siteContent');
    const gallery = document.getElementById('gallery');
    const videoGrid = document.getElementById('videoGrid');
    const modal = document.getElementById('modal');
    const modalImg = document.getElementById('modalImg');
    const caption = document.getElementById('caption');
    const progressFill = document.getElementById('progressFill');
    const giftBox = document.getElementById('giftBox');
    const bdayAudio = document.getElementById('bdayAudio');
    const shayariContainer = document.getElementById('shayariContainer');
    const loveResult = document.getElementById('loveResult');
    const meterFill = document.getElementById('meterFill');
    const messagesDiv = document.getElementById('messages');
    const heartCenter = document.getElementById('heartCenter');
    const heartLeft = document.getElementById('heartLeft');
    const heartRight = document.getElementById('heartRight');

    // Authentication
    function tryUnlock() {
      const user = document.getElementById('username')?.value?.trim();
      const pass = document.getElementById('password')?.value?.trim();
      if (!user || !pass) {
        alert('Username aur password dono bharein');
        return;
      }
      if (user === 'Sumit' && pass === 'PayalForever123') {
        lockScreen.classList.add('hidden');
        setTimeout(() => {
          lockScreen.style.display = 'none';
          siteContent.style.display = 'block';
          startConfetti();
        }, 500);
      } else {
        alert('Access Denied — Incorrect credentials');
      }
    }

    // Gallery Loading
    async function loadGallery() {
      gallery.innerHTML = '<p class="small">Loading photos...</p>';
      for (let i = 1; i <= TOTAL_IMAGES; i++) {
        const src = `images/payal${i}.jpg`;
        const img = new Image();
        img.src = src;
        try {
          await new Promise((resolve, reject) => {
            img.onload = () => {
              imageFiles.push(src);
              resolve();
            };
            img.onerror = () => {
              console.error(`Image ${src} failed to load. Check file path or server.`);
              resolve(); // Continue loading other images
            };
          });
          if (img.complete && img.naturalWidth) {
            const div = document.createElement('div');
            div.className = 'photo';
            div.setAttribute('data-caption', captions[i - 1] || `Memory ${i}`);
            const photoImg = document.createElement('img');
            photoImg.src = src;
            photoImg.alt = `Payal ${i}`;
            applyExifRotation(photoImg);
            photoImg.addEventListener('click', () => {
              console.log(`Opening modal for image index: ${imageFiles.indexOf(src) + 1}`);
              openModal(imageFiles.indexOf(src) + 1);
            });
            div.appendChild(photoImg);
            gallery.appendChild(div);
          }
        } catch (e) {
          console.error(`Error loading image ${src}:`, e);
        }
      }
      if (imageFiles.length === 0) {
        gallery.innerHTML = '<p class="small">No photos found. Please ensure images named payal1.jpg to payal30.jpg are in the images folder.</p>';
      } else {
        gallery.firstChild?.remove(); // Remove loading message
        initializeHeartSlideshow();
      }
    }

    // EXIF Orientation Handling
    function applyExifRotation(img) {
      if (!window.EXIF) {
        console.warn('EXIF library not loaded');
        return;
      }
      EXIF.getData(img, function() {
        const orientation = EXIF.getTag(this, 'Orientation');
        let rotation = 0;
        switch (orientation) {
          case 3: rotation = 180; break;
          case 6: rotation = 90; break;
          case 8: rotation = -90; break;
        }
        if (rotation !== 0) img.style.transform = `rotate(${rotation}deg)`;
      });
    }

    // Modal Slideshow
    function openModal(index) {
      if (imageFiles.length === 0) {
        console.warn('No images available to display in modal');
        return;
      }
      currentImageIndex = Math.max(1, Math.min(index, imageFiles.length));
      modal.classList.add('open');
      updateModal();
    }

    function updateModal() {
      if (!modalImg || !caption) return;
      modalImg.classList.add('fade');
      const src = imageFiles[currentImageIndex - 1] || '';
      modalImg.src = src;
      caption.innerText = captions[currentImageIndex - 1] || 'No caption';
      applyExifRotation(modalImg);
      setTimeout(() => {
        modalImg.classList.remove('fade');
        if (isSlideshowRunning) progressFill.style.width = '0%';
      }, 500);
    }

    function toggleSlideshow() {
      const toggleBtn = document.getElementById('toggleSlideshow');
      if (!toggleBtn) return;
      if (isSlideshowRunning) {
        clearInterval(slideshowInterval);
        toggleBtn.innerText = 'Play ▶';
        isSlideshowRunning = false;
      } else {
        slideshowInterval = setInterval(() => {
          currentImageIndex++;
          if (currentImageIndex > imageFiles.length) {
            clearInterval(slideshowInterval);
            modal.classList.remove('open');
            isSlideshowRunning = false;
            toggleBtn.innerText = 'Play ▶';
          } else {
            updateModal();
            progressFill.style.width = '100%';
          }
        }, 2500);
        toggleBtn.innerText = 'Pause ⏸';
        isSlideshowRunning = true;
      }
    }

    // Heart Slideshow
    function initializeHeartSlideshow() {
      if (imageFiles.length === 0) {
        console.warn('No images available for heart slideshow');
        document.getElementById('heartSlideshow').innerHTML = '<p class="small">No photos available for slideshow.</p>';
        return;
      }
      heartCenter.innerHTML = '';
      heartLeft.innerHTML = '';
      heartRight.innerHTML = '';

      // Center: All images
      imageFiles.forEach(src => {
        const img = document.createElement('img');
        img.src = src;
        applyExifRotation(img);
        heartCenter.appendChild(img);
      });
      const centerImages = heartCenter.getElementsByTagName('img');
      Array.from(centerImages).forEach((img, i) => {
        img.style.opacity = i === 0 ? '1' : '0';
        if (i === 0) img.classList.add('active');
      });

      // Left: Odd-indexed images
      const oddImages = imageFiles.filter((_, i) => i % 2 === 0);
      oddImages.forEach(src => {
        const img = document.createElement('img');
        img.src = src;
        applyExifRotation(img);
        heartLeft.appendChild(img);
      });
      const leftImages = heartLeft.getElementsByTagName('img');
      Array.from(leftImages).forEach((img, i) => {
        img.style.opacity = i === 0 ? '1' : '0';
        if (i === 0) img.classList.add('active');
      });

      // Right: Even-indexed images
      const evenImages = imageFiles.filter((_, i) => i % 2 === 1);
      evenImages.forEach(src => {
        const img = document.createElement('img');
        img.src = src;
        applyExifRotation(img);
        heartRight.appendChild(img);
      });
      const rightImages = heartRight.getElementsByTagName('img');
      Array.from(rightImages).forEach((img, i) => {
        img.style.opacity = i === 0 ? '1' : '0';
        if (i === 0) img.classList.add('active');
      });

      let centerIndex = 0, leftIndex = 0, rightIndex = 0;
      document.getElementById('startHeartSlideshow').addEventListener('click', () => {
        if (!heartInterval && imageFiles.length > 0) {
          playAudio();
          heartInterval = setInterval(() => {
            // Center
            Array.from(centerImages).forEach(img => img.classList.remove('active'));
            centerIndex = (centerIndex + 1) % centerImages.length;
            centerImages[centerIndex].classList.add('active');

            // Left
            if (leftImages.length > 0) {
              Array.from(leftImages).forEach(img => img.classList.remove('active'));
              leftIndex = (leftIndex + 1) % leftImages.length;
              leftImages[leftIndex].classList.add('active');
            }

            // Right
            if (rightImages.length > 0) {
              Array.from(rightImages).forEach(img => img.classList.remove('active'));
              rightIndex = (rightIndex + 1) % rightImages.length;
              rightImages[rightIndex].classList.add('active');
            }
          }, 3000);
        }
      });
    }

    // Video Grid
    function loadVideos() {
      if (!videoGrid) return;
      VIDEOS.forEach(video => {
        const div = document.createElement('div');
        div.className = 'video-container';
        const vid = document.createElement('video');
        vid.controls = true;
        vid.src = video.src;
        vid.type = video.type;
        vid.onerror = () => {
          console.error(`Video ${video.src} failed to load. Check file path or server.`);
          div.innerHTML = '<p class="small">Video not found. Ensure video files are in the videos folder.</p>';
        };
        div.appendChild(vid);
        videoGrid.appendChild(div);
      });
    }

    // Shayari
    function displayShayari() {
      if (!shayariContainer) return;
      shayariContainer.innerHTML = '';
      const shayari = document.createElement('div');
      shayari.className = 'shayari';
      shayari.innerText = SHAYARI_LIST[Math.floor(Math.random() * SHAYARI_LIST.length)] || 'No shayari available';
      shayariContainer.appendChild(shayari);
    }

    // Download Memory Book
    async function downloadMemoryBook() {
      if (!window.jspdf) {
        alert('PDF library not loaded. Please try again later.');
        return;
      }
      if (imageFiles.length === 0) {
        alert('No images available to create memory book.');
        return;
      }
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      const pageWidth = doc.internal.pageSize.getWidth();
      const pageHeight = doc.internal.pageSize.getHeight();
      let yOffset = 20;

      doc.setFontSize(20);
      doc.text("Payal's Memory Book", pageWidth / 2, yOffset, { align: 'center' });
      yOffset += 20;

      try {
        for (let i = 0; i < Math.min(imageFiles.length, 10); i++) { // Limit to 10 images for performance
          const img = new Image();
          img.src = imageFiles[i];
          await new Promise(resolve => {
            img.onload = resolve;
            img.onerror = () => {
              console.warn(`Failed to load image ${imageFiles[i]} for PDF`);
              resolve();
            };
          });

          if (img.complete && img.naturalWidth) {
            const imgProps = doc.getImageProperties(img);
            const imgWidth = pageWidth - 40;
            const imgHeight = (imgProps.height * imgWidth) / imgProps.width;

            if (yOffset + imgHeight + 20 > pageHeight) {
              doc.addPage();
              yOffset = 20;
            }

            doc.addImage(img, 'JPEG', 20, yOffset, imgWidth, imgHeight, '', 'FAST');
            yOffset += imgHeight + 10;
            doc.setFontSize(12);
            doc.text(captions[i] || `Memory ${i + 1}`, pageWidth / 2, yOffset, { align: 'center' });
            yOffset += 20;
          }
        }
        doc.save('Payal_Memory_Book.pdf');
      } catch (e) {
        console.error('Error generating PDF:', e);
        alert('Failed to generate memory book. Please try again.');
      }
    }

    // Surprise Gift
    function openSurprise() {
      if (!giftBox) return;
      giftBox.style.display = 'flex';
      setTimeout(() => {
        giftBox.classList.add('open');
        setTimeout(() => {
          giftBox.style.display = 'none';
          giftBox.classList.remove('open');
          playAudio();
          startFireworks();
          showSecret();
          displayShayari();
          startConfetti();
        }, 1000);
      }, 100);
    }

    function showSecret() {
      const secret = document.createElement('div');
      secret.style.position = 'fixed';
      secret.style.left = '50%';
      secret.style.top = '18%';
      secret.style.transform = 'translateX(-50%)';
      secret.style.background = 'linear-gradient(90deg, #ff9ab3, #ff6b81)';
      secret.style.padding = '12px 16px';
      secret.style.borderRadius = '10px';
      secret.style.color = '#071026';
      secret.style.fontWeight = '800';
      secret.style.zIndex = '1600';
      secret.style.boxShadow = '0 4px 12px rgba(0,0,0,0.3)';
      secret.innerText = 'Happy Birthday Payal — Tum meri duniya ho! ❤️';
      secret.setAttribute('role', 'alert');
      document.body.appendChild(secret);
      setTimeout(() => {
        secret.style.transition = 'all 0.6s';
        secret.style.opacity = '0';
        secret.style.transform = 'translateX(-50%) translateY(-20px)';
      }, 4200);
      setTimeout(() => document.body.removeChild(secret), 5200);
    }

    // Audio
    function playAudio() {
      if (!bdayAudio) return;
      bdayAudio.play().catch(e => {
        console.warn('Audio playback blocked:', e);
        alert('Music blocked by browser — Select a song from the playlist below.');
      });
    }

    // Love Meter
    function checkLove() {
      if (!loveResult || !meterFill) return;
      const percentage = Math.floor(Math.random() * 21) + 80;
      loveResult.innerText = `Hamara pyaar: ${percentage}% 💖`;
      meterFill.style.width = `${percentage}%`;
    }

    // Guestbook
    function loadMessages() {
      if (!messagesDiv) return;
      try {
        const messages = JSON.parse(localStorage.getItem('guestbookMessages') || '[]');
        messagesDiv.innerHTML = '';
        messages.forEach(msg => {
          const div = document.createElement('div');
          div.className = 'message';
          div.innerText = msg;
          messagesDiv.appendChild(div);
        });
      } catch (e) {
        console.error('Failed to load guestbook messages:', e);
      }
    }

    function submitMessage() {
      const input = document.getElementById('guestbookInput');
      if (!input) return;
      const message = input.value.trim();
      if (message) {
        try {
          const messages = JSON.parse(localStorage.getItem('guestbookMessages') || '[]');
          messages.push(message);
          localStorage.setItem('guestbookMessages', JSON.stringify(messages));
          input.value = '';
          loadMessages();
        } catch (e) {
          console.error('Failed to save message:', e);
          alert('Failed to save message. Storage may be full or disabled.');
        }
      }
    }

    // Animations
    function startStars() {
      const canvas = document.getElementById('stars');
      if (!canvas) return;
      const ctx = canvas.getContext('2d');
      function resize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
      }
      resize();
      window.addEventListener('resize', resize);
      const stars = Array(50).fill().map(() => ({
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height,
        size: Math.random() * 2 + 1,
        opacity: Math.random() * 0.5 + 0.3
      }));
      let frameCount = 0;
      function animate() {
        if (frameCount > 300) return;
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        stars.forEach(s => {
          ctx.globalAlpha = s.opacity + Math.sin(Date.now() / 1000 + s.x) * 0.2;
          ctx.fillStyle = '#e6eef8';
          ctx.beginPath();
          ctx.arc(s.x, s.y, s.size, 0, Math.PI * 2);
          ctx.fill();
        });
        frameCount++;
        requestAnimationFrame(animate);
      }
      animate();
    }

    function startFireworks() {
      const canvas = document.getElementById('fire');
      if (!canvas) return;
      const ctx = canvas.getContext('2d');
      function resize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
      }
      resize();
      window.addEventListener('resize', resize);
      const particles = [];
      const colors = ['#ff6b81', '#ffd76b', '#6bffea', '#9ab3ff', '#ff9ab3'];
      for (let c = 0; c < 10; c++) {
        const cx = Math.random() * canvas.width;
        const cy = Math.random() * canvas.height * 0.4;
        for (let i = 0; i < 50; i++) {
          const angle = Math.random() * Math.PI * 2;
          const speed = Math.random() * 4 + 2;
          particles.push({ x: cx, y: cy, vx: Math.cos(angle) * speed, vy: Math.sin(angle) * speed, life: Math.random() * 60 + 40, color: colors[Math.floor(Math.random() * colors.length)], size: Math.random() * 2 + 1 });
        }
      }
      let t = 0;
      const raf = setInterval(() => {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        for (let i = particles.length - 1; i >= 0; i--) {
          const p = particles[i];
          p.x += p.vx; p.y += p.vy; p.vy += 0.05; p.life--;
          ctx.globalAlpha = Math.max(0, p.life / 60);
          ctx.fillStyle = p.color;
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
          ctx.fill();
          if (p.life <= 0) particles.splice(i, 1);
        }
        t++;
        if (t > 200 || particles.length === 0) {
          clearInterval(raf);
          ctx.clearRect(0, 0, canvas.width, canvas.height);
        }
      }, 16);
    }

    function startConfetti() {
      const canvas = document.getElementById('fire');
      if (!canvas) return;
      const ctx = canvas.getContext('2d');
      const particles = [];
      const colors = ['#ff6b81', '#ffd76b', '#6bffea', '#9ab3ff', '#ff9ab3'];
      const shapes = ['circle', 'heart'];
      for (let i = 0; i < 60; i++) {
        particles.push({ x: Math.random() * canvas.width, y: -10, vx: (Math.random() - 0.5) * 4, vy: Math.random() * 4 + 2, size: Math.random() * 8 + 4, color: colors[Math.floor(Math.random() * colors.length)], rotation: Math.random() * 360, life: 100, shape: shapes[Math.floor(Math.random() * shapes.length)] });
      }
      let frameCount = 0;
      const raf = setInterval(() => {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        for (let i = particles.length - 1; i >= 0; i--) {
          const p = particles[i];
          p.x += p.vx; p.y += p.vy; p.vy += 0.02; p.rotation += 4; p.life--;
          ctx.globalAlpha = Math.max(0, p.life / 100);
          ctx.fillStyle = p.color;
          ctx.save(); ctx.translate(p.x, p.y); ctx.rotate((p.rotation * Math.PI) / 180);
          if (p.shape === 'circle') {
            ctx.beginPath(); ctx.arc(0, 0, p.size / 2, 0, Math.PI * 2); ctx.fill();
          } else if (p.shape === 'heart') {
            ctx.beginPath(); ctx.moveTo(0, p.size / 2); ctx.bezierCurveTo(-p.size, -p.size / 2, -p.size, -p.size * 1.5, 0, -p.size); ctx.bezierCurveTo(p.size, -p.size * 1.5, p.size, -p.size / 2, 0, p.size / 2); ctx.fill();
          }
          ctx.restore();
          if (p.life <= 0) particles.splice(i, 1);
        }
        frameCount++;
        if (frameCount > 200 || particles.length === 0) {
          clearInterval(raf);
          ctx.clearRect(0, 0, canvas.width, canvas.height);
        }
      }, 16);
    }

    // Event Listeners
    document.getElementById('unlockBtn')?.addEventListener('click', tryUnlock);
    document.getElementById('openGuest')?.addEventListener('click', () => {
      alert('Hint: Username is Sumit. Password ke liye Sumit se baat karo!');
    });
    document.getElementById('openSurprise')?.addEventListener('click', openSurprise);
    document.getElementById('downloadBook')?.addEventListener('click', downloadMemoryBook);
    document.getElementById('next')?.addEventListener('click', () => {
      currentImageIndex++;
      if (currentImageIndex > imageFiles.length) currentImageIndex = 1;
      updateModal();
    });
    document.getElementById('prev')?.addEventListener('click', () => {
      currentImageIndex--;
      if (currentImageIndex < 1) currentImageIndex = imageFiles.length;
      updateModal();
    });
    document.getElementById('closeModal')?.addEventListener('click', () => {
      modal.classList.remove('open');
      if (isSlideshowRunning) toggleSlideshow();
    });
    document.getElementById('toggleSlideshow')?.addEventListener('click', toggleSlideshow);
    document.getElementById('playSong')?.addEventListener('click', () => {
      bdayAudio.src = document.getElementById('songSelect')?.value || 'audio/song1.mp3';
      playAudio();
    });
    document.getElementById('pauseSong')?.addEventListener('click', () => bdayAudio?.pause());
    document.getElementById('checkLove')?.addEventListener('click', checkLove);
    document.getElementById('submitMessage')?.addEventListener('click', submitMessage);

    modal?.addEventListener('click', (e) => {
      if (e.target === modal) {
        modal.classList.remove('open');
        if (isSlideshowRunning) toggleSlideshow();
      }
    });

    document.addEventListener('keydown', (e) => {
      if (!modal?.classList.contains('open')) return;
      if (e.key === 'ArrowRight') {
        currentImageIndex++;
        if (currentImageIndex > imageFiles.length) currentImageIndex = 1;
        updateModal();
      } else if (e.key === 'ArrowLeft') {
        currentImageIndex--;
        if (currentImageIndex < 1) currentImageIndex = imageFiles.length;
        updateModal();
      } else if (e.key === 'Escape') {
        modal.classList.remove('open');
        if (isSlideshowRunning) toggleSlideshow();
      }
    });

    if (modal) {
      let lastSwipe = 0;
      const mc = new Hammer(modal);
      mc.on('swipeleft', () => {
        const now = Date.now();
        if (now - lastSwipe < 300) return; // Throttle swipes
        lastSwipe = now;
        currentImageIndex++;
        if (currentImageIndex > imageFiles.length) currentImageIndex = 1;
        updateModal();
      });
      mc.on('swiperight', () => {
        const now = Date.now();
        if (now - lastSwipe < 300) return;
        lastSwipe = now;
        currentImageIndex--;
        if (currentImageIndex < 1) currentImageIndex = imageFiles.length;
        updateModal();
      });
    }

    // Initialization
    window.addEventListener('load', () => {
      loadGallery();
      loadVideos();
      displayShayari();
      loadMessages();
      startStars();
    });
  </script>
</body>
</html>